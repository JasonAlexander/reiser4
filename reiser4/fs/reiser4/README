Start reading this code by reading balance.c first.